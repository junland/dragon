To: vim_dev@googlegroups.com
Subject: Patch 8.0.0346
Fcc: outbox
From: Bram Moolenaar <Bram@moolenaar.net>
Mime-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit
------------

Patch 8.0.0346
Problem:    Vim relies on limits.h to be included indirectly, but on Solaris 9
            it may not be. (Ben Fritz)
Solution:   Always include limits.h.
Files:      src/os_unixx.h, src/vim.h


*** ../vim-8.0.0345/src/os_unixx.h	2017-01-12 20:06:30.152522974 +0100
--- src/os_unixx.h	2017-02-21 21:56:38.403785632 +0100
***************
*** 69,84 ****
  #endif
  
  #ifdef HAVE_SYS_SYSTEMINFO_H
! /*
!  * foolish Sinix <sys/systeminfo.h> uses SYS_NMLN but doesn't include
!  * <limits.h>, where it is defined. Perhaps other systems have the same
!  * problem? Include it here. -- Slootman
!  */
! # if defined(HAVE_LIMITS_H) && !defined(_LIMITS_H)
! #  include <limits.h>		/* for SYS_NMLN (Sinix 5.41 / Unix SysV.4) */
! # endif
! 
! /* Define SYS_NMLN ourselves if it still isn't defined (for CrayT3E). */
  # ifndef SYS_NMLN
  #  define SYS_NMLN 32
  # endif
--- 69,75 ----
  #endif
  
  #ifdef HAVE_SYS_SYSTEMINFO_H
! /* <sys/systeminfo.h> uses SYS_NMLN but it may not be defined (CrayT3E). */
  # ifndef SYS_NMLN
  #  define SYS_NMLN 32
  # endif
*** ../vim-8.0.0345/src/vim.h	2017-02-21 20:47:09.966394747 +0100
--- src/vim.h	2017-02-21 21:48:00.687143800 +0100
***************
*** 487,492 ****
--- 487,495 ----
  # include <errno.h>
  #endif
  
+ /* for INT_MAX et al. */
+ #include <limits.h>
+ 
  /*
   * Allow other (non-unix) systems to configure themselves now
   * These are also in os_unix.h, because osdef.sh needs them there.
*** ../vim-8.0.0345/src/version.c	2017-02-21 20:47:09.966394747 +0100
--- src/version.c	2017-02-21 21:55:45.972124468 +0100
***************
*** 766,767 ****
--- 766,769 ----
  {   /* Add new patch number below this line */
+ /**/
+     346,
  /**/

-- 
I used to be indecisive, now I'm not sure.

 /// Bram Moolenaar -- Bram@Moolenaar.net -- http://www.Moolenaar.net   \\\
///        sponsor Vim, vote for features -- http://www.Vim.org/sponsor/ \\\
\\\  an exciting new programming language -- http://www.Zimbu.org        ///
 \\\            help me help AIDS victims -- http://ICCF-Holland.org    ///
